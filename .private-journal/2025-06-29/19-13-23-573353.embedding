{
  "embedding": [
    -0.02868068218231201,
    -0.06285460293292999,
    0.04614029824733734,
    0.010611679404973984,
    0.008086871355772018,
    0.03333968669176102,
    0.0079962108284235,
    -0.01778942160308361,
    0.009209156967699528,
    0.004353391472250223,
    0.044224370270967484,
    -0.03424622118473053,
    -0.03658680245280266,
    0.009289574809372425,
    0.0271471980959177,
    -0.020855266600847244,
    0.02868366800248623,
    -0.07617872208356857,
    -0.11660251021385193,
    -0.04370506852865219,
    0.052772313356399536,
    -0.07833843678236008,
    0.0088927261531353,
    0.013816045597195625,
    -0.03167206048965454,
    0.022678332403302193,
    -0.03928929939866066,
    -0.07332075387239456,
    0.020313987508416176,
    0.003710349090397358,
    -0.010626137256622314,
    0.008888385258615017,
    -0.1077929362654686,
    -0.0029424591921269894,
    -0.027140697464346886,
    -0.016481518745422363,
    -0.016807299107313156,
    0.0035492500755935907,
    -0.0619833879172802,
    -0.11804916709661484,
    -0.010136794298887253,
    0.08257956802845001,
    0.006662191357463598,
    -0.00907581765204668,
    0.0023544474970549345,
    -0.04716379940509796,
    -0.02022378146648407,
    -0.06627395749092102,
    -0.06964917480945587,
    0.0016951031284406781,
    -0.0725589171051979,
    -0.017180584371089935,
    0.03886844590306282,
    0.009263436309993267,
    0.12399338185787201,
    0.07329726964235306,
    0.008459986187517643,
    0.035560671240091324,
    0.06367255747318268,
    -0.011396314017474651,
    -0.06295330077409744,
    0.017819877713918686,
    -0.058185577392578125,
    -0.05259184539318085,
    0.02221057564020157,
    0.11824405193328857,
    0.023015907034277916,
    -0.06317227333784103,
    0.022263891994953156,
    -0.016332127153873444,
    -0.024356061592698097,
    -0.027904560789465904,
    -0.008123456500470638,
    -0.06270155310630798,
    0.016587287187576294,
    -0.027737490832805634,
    -0.011340114288032055,
    -0.042109571397304535,
    -0.011038519442081451,
    -0.10257722437381744,
    0.07945936173200607,
    -0.012148428708314896,
    -0.02480890601873398,
    -0.006359809078276157,
    0.10235732048749924,
    -0.006186193786561489,
    -0.016232045367360115,
    -0.09722451865673065,
    0.010544540360569954,
    0.05786428973078728,
    0.022836167365312576,
    -0.09464292973279953,
    0.1628194898366928,
    0.012572716921567917,
    0.08844368159770966,
    -0.014278624206781387,
    0.03974369913339615,
    0.03836105763912201,
    0.025472896173596382,
    0.009722302667796612,
    0.02881036326289177,
    -0.05713922157883644,
    -0.046149492263793945,
    -0.0011627281783148646,
    -0.004077996127307415,
    0.04611518234014511,
    -0.003374014748260379,
    -0.10541173070669174,
    -0.10469450801610947,
    -0.022542374208569527,
    -0.0012895071413367987,
    0.016337256878614426,
    -0.031371865421533585,
    -0.04367491230368614,
    -0.026297157630324364,
    0.03851627558469772,
    0.04391571506857872,
    0.023991288617253304,
    0.11317978799343109,
    0.044359881430864334,
    0.01153575163334608,
    -0.033920712769031525,
    -0.01002890057861805,
    0.000018485905457055196,
    0.02416662685573101,
    -0.04369436576962471,
    0.006676896475255489,
    1.041731322159167e-32,
    -0.029788699001073837,
    -0.07612623274326324,
    -0.1341235190629959,
    0.019433867186307907,
    0.061570651829242706,
    0.07589878141880035,
    0.002257131040096283,
    0.0014188591158017516,
    -0.02929511107504368,
    -0.03132135793566704,
    -0.0035685503389686346,
    -0.01040251087397337,
    -0.03365008533000946,
    -0.0773942694067955,
    0.10620004683732986,
    -0.10944779962301254,
    0.015704991295933723,
    0.14119461178779602,
    -0.025480953976511955,
    0.06080765649676323,
    0.005605124402791262,
    -0.008920448832213879,
    -0.03307316079735756,
    -0.05345747247338295,
    0.07826868444681168,
    0.017575787380337715,
    -0.021481383591890335,
    0.012574909254908562,
    -0.00910178478807211,
    0.017517585307359695,
    -0.04914632812142372,
    0.06158477067947388,
    -0.02473158948123455,
    0.046601470559835434,
    -0.007376255001872778,
    -0.01473291963338852,
    0.02419881895184517,
    -0.04747115820646286,
    0.02754923328757286,
    -0.029367879033088684,
    -0.11163569986820221,
    0.015078024938702583,
    -0.08897968381643295,
    -0.036324694752693176,
    -0.007715611252933741,
    -0.0651385709643364,
    -0.033509086817502975,
    0.02723369374871254,
    0.04635077714920044,
    0.005268678534775972,
    0.04380272701382637,
    0.051150135695934296,
    0.04957183077931404,
    -0.11067858338356018,
    0.027174722403287888,
    0.006472254637628794,
    0.0022665648721158504,
    0.024972710758447647,
    0.11920030415058136,
    0.14360235631465912,
    0.015057622455060482,
    -0.025410665199160576,
    -0.04044778645038605,
    0.04023674130439758,
    0.06953378766775131,
    0.07856083661317825,
    -0.038751713931560516,
    0.01379734929651022,
    0.03965739905834198,
    -0.024927612394094467,
    -0.07423636317253113,
    0.0024650045670568943,
    0.0774620994925499,
    -0.03020573779940605,
    0.0655272826552391,
    -0.011094165965914726,
    -0.07951106131076813,
    0.014053340069949627,
    -0.08300711959600449,
    -0.030707912519574165,
    -0.031174587085843086,
    -0.000010773279427667148,
    0.007982135750353336,
    0.06126966327428818,
    0.024818481877446175,
    -0.05907448008656502,
    -0.0837307795882225,
    0.04666776955127716,
    -0.06368064135313034,
    -0.02748526819050312,
    0.02933512069284916,
    -0.01821725070476532,
    0.035645924508571625,
    0.006547214929014444,
    -0.01558656431734562,
    -9.477290960390226e-33,
    0.01792627014219761,
    0.011762682348489761,
    -0.019725581631064415,
    -0.009378028102219105,
    -0.022100210189819336,
    -0.01766262948513031,
    -0.028137441724538803,
    -0.04253196716308594,
    0.008344731293618679,
    -0.08297177404165268,
    -0.01641877554357052,
    0.0032415781170129776,
    0.005195206962525845,
    -0.013293358497321606,
    -0.050243914127349854,
    0.04758363962173462,
    0.010434533469378948,
    -0.012420308776199818,
    0.005356570705771446,
    -0.01068118680268526,
    0.10786253958940506,
    -0.04200633615255356,
    -0.10881734639406204,
    -0.013103182427585125,
    -0.019224004819989204,
    0.05370486527681351,
    0.011211726814508438,
    0.06657969951629639,
    0.13928119838237762,
    -0.06729166954755783,
    -0.04647864028811455,
    0.046946726739406586,
    -0.013114254921674728,
    -0.037240538746118546,
    -0.022357014939188957,
    0.022471869364380836,
    0.0005298633477650583,
    -0.05134188011288643,
    -0.048063039779663086,
    -0.017676448449492455,
    0.10784192383289337,
    0.029877537861466408,
    0.030735891312360764,
    0.030148062855005264,
    -0.000701894867233932,
    0.07881449908018112,
    -0.023940585553646088,
    0.037436895072460175,
    -0.048644620925188065,
    0.003183063119649887,
    -0.02782522141933441,
    -0.061548441648483276,
    -0.018640650436282158,
    -0.03937367722392082,
    -0.06842942535877228,
    0.03750799968838692,
    0.06778363883495331,
    -0.040885914117097855,
    -0.005167250521481037,
    -0.045179665088653564,
    0.08467815071344376,
    -0.012257370166480541,
    0.041786666959524155,
    0.02029414474964142,
    0.09774874895811081,
    0.031168242916464806,
    -0.005409718491137028,
    -0.03431696817278862,
    0.050126608461141586,
    0.0034101195633411407,
    0.060968298465013504,
    -0.005074001848697662,
    -0.04845697432756424,
    -0.046499840915203094,
    0.01024168822914362,
    0.11112301796674728,
    0.05314240604639053,
    -0.03215949237346649,
    0.06184697523713112,
    0.02705281227827072,
    -0.0631776750087738,
    0.02454410307109356,
    0.03565043956041336,
    -0.013852971605956554,
    -0.01759057492017746,
    0.1313043236732483,
    -0.017824620008468628,
    0.07197516411542892,
    0.07604943960905075,
    -0.026622191071510315,
    -0.0763046145439148,
    -0.07229054719209671,
    -0.013916801661252975,
    0.06539703160524368,
    0.049682676792144775,
    -6.074837699543423e-8,
    -0.015067779459059238,
    0.06771064549684525,
    -0.10338151454925537,
    0.0031129091512411833,
    -0.04220518469810486,
    -0.0498003251850605,
    0.017506342381238937,
    0.012846588157117367,
    0.003402166999876499,
    -0.03268437460064888,
    0.005619050934910774,
    0.03845429793000221,
    -0.02204860933125019,
    -0.023869920521974564,
    0.04282618686556816,
    0.020535487681627274,
    -0.04324033111333847,
    0.043154552578926086,
    -0.057228196412324905,
    -0.03111882321536541,
    0.039667412638664246,
    -0.027200717478990555,
    -0.01327942218631506,
    0.017794815823435783,
    -0.09098444133996964,
    0.004171227104961872,
    0.0048440671525895596,
    0.17366114258766174,
    0.06223747506737709,
    -0.06168309599161148,
    0.017789682373404503,
    -0.007396752014756203,
    -0.019236158579587936,
    -0.005497025791555643,
    -0.11659055948257446,
    -0.007156293373554945,
    -0.004157188814133406,
    -0.005965670105069876,
    0.06602020561695099,
    0.040650658309459686,
    0.026412036269903183,
    -0.07373301684856415,
    -0.03819061815738678,
    0.04788757860660553,
    -0.006869438104331493,
    0.048295676708221436,
    -0.016838060691952705,
    -0.019048374146223068,
    0.022381452843546867,
    0.008236687630414963,
    -0.08562139421701431,
    0.029216548427939415,
    -0.0423470064997673,
    0.053820278495550156,
    0.004015093203634024,
    0.07363586872816086,
    0.08553042262792587,
    -0.03162934258580208,
    0.05618678778409958,
    -0.0096847303211689,
    0.07524624466896057,
    -0.012264115735888481,
    -0.05649099498987198,
    0.06249620020389557
  ],
  "text": "Recent commits fixed the timeline focus issues through several key improvements:\n\n### 1. Core Problem Solved\n**Issue**: Multiple timelines (main + delegate) were responding to the same keyboard events, causing interference.\n\n**Solution**: Implemented focus region isolation where each timeline has its own focus scope and only processes events when focused.\n\n### 2. Key Architectural Changes\n\n**A. Focus Region Scoping (TimelineViewport.tsx lines 85-99)**:\n- Main timeline uses `FocusRegions.timeline` \n- Delegate timelines use `FocusRegions.delegate(threadId)`\n- TimelineViewport checks current focus context before processing keys\n- Prevents main timeline from handling keys when in delegate context\n\n**B. Event Emitter Isolation (useTimelineExpansionToggle.tsx)**:\n- Each `TimelineExpansionProvider` creates its own `ExpansionEmitter` instance\n- Timeline-to-item communication isolated within provider scope\n- Multiple timelines don't interfere with each other's expansion events\n\n**C. Keyboard Delegation (DelegateToolRenderer.tsx lines 71-83)**:\n- Escape key handled locally in delegate renderer\n- Delegate timeline wrapped with isolated expansion provider\n- Local expansion state (`delegationExpanded`) for internal control\n\n### 3. Debugging Tools Added\n- Added `/debug-focus` command to toggle focus debug panel\n- Provides real-time visibility into focus stack and state\n- Helps developers understand which component has focus\n\n### 4. Test Coverage\n- `timeline-focus-isolation.test.tsx`: Tests focus region separation\n- `timeline-focus-integration.test.tsx`: E2E focus lifecycle tests\n- Comprehensive coverage of edge cases and error conditions\n\n### 5. What Was Fixed\n✅ Arrow key interference between main and delegate timelines\n✅ Escape key not working to exit delegate focus\n✅ Multiple timelines responding to same keyboard events\n✅ Focus state management across timeline instances\n✅ Event bubbling causing unintended navigation\n\n### 6. Architecture Quality\nThe solution demonstrates excellent architectural patterns:\n- Clean separation of concerns\n- Composable isolation using React context\n- Predictable focus behavior\n- Testable interfaces\n- No global state pollution\n\nThis is a robust solution that should handle complex scenarios like nested delegates and multiple concurrent timelines without issues.",
  "sections": [
    "Project Notes",
    "Timeline Focus Isolation Analysis"
  ],
  "timestamp": 1751249603573,
  "path": "/Users/jesse/Documents/GitHub/lace/.private-journal/2025-06-29/19-13-23-573353.md"
}