---
title: "11:56:32 AM - July 12, 2025"
date: 2025-07-12T18:56:32.257Z
timestamp: 1752346592257
---

## Project Notes

## Lace Architecture Analysis

Just completed a comprehensive analysis of the Lace codebase structure. Key findings:

### Entry Point Architecture
- **Main CLI entry**: `/src/cli.ts` - lightweight entry point that delegates to `/src/app.ts`
- **App orchestration**: `/src/app.ts` - core application setup and component initialization
- **Interface selection**: Based on CLI flags, not separate entry points
- **Web interface**: Next.js 15 app in parallel, not integrated into main CLI flow

### Current Web Interface
- **Frontend**: Next.js 15 App Router with React 18, TypeScript, Tailwind CSS 4.x
- **Main component**: `LaceApp.tsx` - comprehensive chat interface with timeline, tools, voice
- **API integration**: Real streaming API at `/api/conversations/stream` using Server-Sent Events
- **Core integration**: Web API creates full Agent instances, uses same ThreadManager/ToolExecutor

### Interface Architecture
- **Terminal Interface**: Rich Ink/React terminal UI with real-time updates
- **Non-Interactive**: Single prompt execution mode
- **Web Interface**: Separate Next.js app, not integrated into CLI launcher

### Key Architectural Patterns
- **Event-sourcing**: All conversations stored as immutable event sequences
- **Three-layer system**: Data (ThreadManager), Logic (Agent/Tools), Interface (Terminal/Web)
- **Provider abstraction**: Supports multiple AI providers (Anthropic, OpenAI, etc.)
- **Tool system**: 11 tools with user approval workflow

### Build System
- **CLI**: TypeScript compilation to `dist/` with `tsc` and `tsc-alias`
- **Web**: Next.js build system with webpack alias configuration
- **Path mapping**: Both systems use `~/*` aliases for clean imports

### Current Limitations
- Web interface is separate app, not launched from CLI
- No unified interface selection mechanism
- Web interface has mock data mixed with real API calls
- No shared state management between CLI and web modes
