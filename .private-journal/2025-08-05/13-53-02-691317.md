---
title: "1:53:02 PM - August 5, 2025"
date: 2025-08-05T17:53:02.691Z
timestamp: 1754416382691
---

## Project Notes

Jesse is asking a really important question. Let me think through this:

1. `temp-lace-dir.ts` sets `process.env.LACE_DIR` to an isolated temp directory
2. `ProviderInstanceManager` uses `getLaceDir()` which reads `process.env.LACE_DIR`
3. So provider instances automatically get isolated to the temp directory

But what about the database/persistence? Let me trace through this:

1. `persistence-helper.ts` creates its own random temp database file (like `/tmp/lace-test-xyz789.db`)
2. But `getLaceDir()` returns the temp LACE_DIR (like `/tmp/lace-test-abc123/`)
3. So we'd want the database to be at `/tmp/lace-test-abc123/lace.db` to be in the same directory

The question is: does the persistence system automatically use `getLaceDir()` or does it need explicit setup?

Looking at the persistence system, I think it needs explicit initialization with a database path. So `temp-lace-dir.ts` sets the environment variable, but the persistence system still needs to be explicitly initialized to use a database file within that temp directory.

So we still need some kind of persistence setup, but maybe it could be simpler - just initialize persistence to use `${LACE_DIR}/lace.db` automatically.
